
import { __decorate, __param } from '@codingame/monaco-vscode-api/external/tslib/tslib.es6';
import { Disposable } from '@codingame/monaco-vscode-api/vscode/vs/base/common/lifecycle';
import { StorageScope, StorageTarget } from '@codingame/monaco-vscode-api/vscode/vs/platform/storage/common/storage';
import { IStorageService } from '@codingame/monaco-vscode-api/vscode/vs/platform/storage/common/storage.service';
import { Extensions } from '@codingame/monaco-vscode-api/vscode/vs/workbench/services/extensionManagement/common/extensionFeatures';
import { IExtensionFeaturesManagementService } from '@codingame/monaco-vscode-api/vscode/vs/workbench/services/extensionManagement/common/extensionFeatures.service';
import { Registry } from '@codingame/monaco-vscode-api/vscode/vs/platform/registry/common/platform';
import { localize } from '@codingame/monaco-vscode-api/vscode/vs/nls';
import { Codicon } from '@codingame/monaco-vscode-api/vscode/vs/base/common/codicons';

let LanguageModelStatsService = class LanguageModelStatsService extends Disposable {
    constructor(extensionFeaturesManagementService, storageService) {
        super();
        this.extensionFeaturesManagementService = extensionFeaturesManagementService;
        for (const key in ( storageService.keys(StorageScope.APPLICATION, StorageTarget.USER))) {
            if (key.startsWith('languageModelStats.') || key.startsWith('languageModelAccess.')) {
                storageService.remove(key, StorageScope.APPLICATION);
            }
        }
    }
    async update(model, extensionId, agent, tokenCount) {
        await this.extensionFeaturesManagementService.getAccess(extensionId, CopilotUsageExtensionFeatureId);
    }
};
LanguageModelStatsService = ( __decorate([
    ( __param(0, IExtensionFeaturesManagementService)),
    ( __param(1, IStorageService))
], LanguageModelStatsService));
const CopilotUsageExtensionFeatureId = 'copilot';
( Registry.as(Extensions.ExtensionFeaturesRegistry)).registerExtensionFeature({
    id: CopilotUsageExtensionFeatureId,
    label: ( localize(4859, "Copilot")),
    description: ( localize(4860, "Language models usage statistics of this extension.")),
    icon: Codicon.copilot,
    access: {
        canToggle: false
    },
    accessDataLabel: ( localize(4861, "chat")),
});

export { CopilotUsageExtensionFeatureId, LanguageModelStatsService };
