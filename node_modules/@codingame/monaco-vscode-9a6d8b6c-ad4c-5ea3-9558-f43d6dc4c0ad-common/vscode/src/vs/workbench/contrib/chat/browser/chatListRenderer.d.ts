import { DropdownMenuActionViewItem, IDropdownMenuActionViewItemOptions } from "@codingame/monaco-vscode-api/vscode/vs/base/browser/ui/dropdown/dropdownActionViewItem";
import { IListVirtualDelegate } from "@codingame/monaco-vscode-api/vscode/vs/base/browser/ui/list/list";
import { ITreeNode, ITreeRenderer } from "@codingame/monaco-vscode-api/vscode/vs/base/browser/ui/tree/tree";
import { IAction } from "@codingame/monaco-vscode-api/vscode/vs/base/common/actions";
import { Emitter, Event } from "@codingame/monaco-vscode-api/vscode/vs/base/common/event";
import { FuzzyScore } from "@codingame/monaco-vscode-api/vscode/vs/base/common/filters";
import { Disposable, DisposableStore, IDisposable } from "@codingame/monaco-vscode-api/vscode/vs/base/common/lifecycle";
import { URI } from "@codingame/monaco-vscode-api/vscode/vs/base/common/uri";
import { MenuWorkbenchToolBar } from "@codingame/monaco-vscode-api/vscode/vs/platform/actions/browser/toolbar";
import { ICommandService } from "@codingame/monaco-vscode-api/vscode/vs/platform/commands/common/commands.service";
import { IConfigurationService } from "@codingame/monaco-vscode-api/vscode/vs/platform/configuration/common/configuration.service";
import { IContextKeyService } from "@codingame/monaco-vscode-api/vscode/vs/platform/contextkey/common/contextkey.service";
import { IContextMenuService } from "@codingame/monaco-vscode-api/vscode/vs/platform/contextview/browser/contextView.service";
import { IHoverService } from "@codingame/monaco-vscode-api/vscode/vs/platform/hover/browser/hover.service";
import { IInstantiationService } from "@codingame/monaco-vscode-api/vscode/vs/platform/instantiation/common/instantiation";
import { ILogService } from "@codingame/monaco-vscode-api/vscode/vs/platform/log/common/log.service";
import { IThemeService } from "@codingame/monaco-vscode-api/vscode/vs/platform/theme/common/themeService.service";
import { IWorkbenchIssueService } from "@codingame/monaco-vscode-api/vscode/vs/workbench/contrib/issue/common/issue.service";
import { IChatFollowup } from "@codingame/monaco-vscode-api/vscode/vs/workbench/contrib/chat/common/chatService";
import { IChatResponseViewModel } from "../common/chatViewModel.js";
import { CodeBlockModelCollection } from "../common/codeBlockModelCollection.js";
import { ChatTreeItem, IChatCodeBlockInfo, IChatFileTreeInfo, IChatListItemRendererOptions } from "./chat.js";
import { IChatWidgetService } from "@codingame/monaco-vscode-api/vscode/vs/workbench/contrib/chat/browser/chat.service";
import { ChatAgentHover } from "./chatAgentHover.js";
import { IChatContentPart } from "@codingame/monaco-vscode-api/vscode/vs/workbench/contrib/chat/browser/chatContentParts/chatContentParts";
import { ChatEditorOptions } from "./chatOptions.js";
import { CodeBlockPart } from "./codeBlockPart.js";
interface IChatListItemTemplate {
    currentElement?: ChatTreeItem;
    renderedParts?: IChatContentPart[];
    readonly rowContainer: HTMLElement;
    readonly titleToolbar?: MenuWorkbenchToolBar;
    readonly footerToolbar: MenuWorkbenchToolBar;
    readonly avatarContainer: HTMLElement;
    readonly username: HTMLElement;
    readonly detail: HTMLElement;
    readonly value: HTMLElement;
    readonly contextKeyService: IContextKeyService;
    readonly instantiationService: IInstantiationService;
    readonly templateDisposables: IDisposable;
    readonly elementDisposables: DisposableStore;
    readonly agentHover: ChatAgentHover;
}
interface IItemHeightChangeParams {
    element: ChatTreeItem;
    height: number;
}
export interface IChatRendererDelegate {
    container: HTMLElement;
    getListLength(): number;
    readonly onDidScroll?: Event<void>;
}
export declare class ChatListItemRenderer extends Disposable implements ITreeRenderer<ChatTreeItem, FuzzyScore, IChatListItemTemplate> {
    private readonly rendererOptions;
    private readonly delegate;
    private readonly codeBlockModelCollection;
    private readonly instantiationService;
    private readonly logService;
    private readonly contextKeyService;
    private readonly themeService;
    private readonly commandService;
    private readonly hoverService;
    private readonly chatWidgetService;
    static readonly ID = "item";
    private readonly codeBlocksByResponseId;
    private readonly codeBlocksByEditorUri;
    private readonly fileTreesByResponseId;
    private readonly focusedFileTreesByResponseId;
    private readonly renderer;
    private readonly markdownDecorationsRenderer;
    protected readonly _onDidClickFollowup: Emitter<IChatFollowup>;
    readonly onDidClickFollowup: Event<IChatFollowup>;
    private readonly _onDidClickRerunWithAgentOrCommandDetection;
    readonly onDidClickRerunWithAgentOrCommandDetection: Event<{
        sessionId: string;
        requestId: string;
    }>;
    protected readonly _onDidChangeItemHeight: Emitter<IItemHeightChangeParams>;
    readonly onDidChangeItemHeight: Event<IItemHeightChangeParams>;
    private readonly _editorPool;
    private readonly _toolEditorPool;
    private readonly _diffEditorPool;
    private readonly _treePool;
    private readonly _contentReferencesListPool;
    private _currentLayoutWidth;
    private _isVisible;
    private _onDidChangeVisibility;
    private readonly _toolInvocationCodeBlockCollection;
    constructor(editorOptions: ChatEditorOptions, rendererOptions: IChatListItemRendererOptions, delegate: IChatRendererDelegate, codeBlockModelCollection: CodeBlockModelCollection, overflowWidgetsDomNode: HTMLElement | undefined, instantiationService: IInstantiationService, configService: IConfigurationService, logService: ILogService, contextKeyService: IContextKeyService, themeService: IThemeService, commandService: ICommandService, hoverService: IHoverService, chatWidgetService: IChatWidgetService);
    get templateId(): string;
    editorsInUse(): Iterable<CodeBlockPart>;
    private traceLayout;
    private getProgressiveRenderRate;
    getCodeBlockInfosForResponse(response: IChatResponseViewModel): IChatCodeBlockInfo[];
    getCodeBlockInfoForEditor(uri: URI): IChatCodeBlockInfo | undefined;
    getFileTreeInfosForResponse(response: IChatResponseViewModel): IChatFileTreeInfo[];
    getLastFocusedFileTreeForResponse(response: IChatResponseViewModel): IChatFileTreeInfo | undefined;
    setVisible(visible: boolean): void;
    layout(width: number): void;
    renderTemplate(container: HTMLElement): IChatListItemTemplate;
    renderElement(node: ITreeNode<ChatTreeItem, FuzzyScore>, index: number, templateData: IChatListItemTemplate): void;
    private clearRenderedParts;
    renderChatTreeItem(element: ChatTreeItem, index: number, templateData: IChatListItemTemplate): void;
    private renderDetail;
    private _renderDetail;
    private renderConfirmationAction;
    private renderAvatar;
    private getAgentIcon;
    private basicRenderElement;
    private updateItemHeight;
    private doNextProgressiveRender;
    private renderChatContentDiff;
    private getNextProgressiveRenderContent;
    private shouldShowWorkingProgress;
    private getDataForProgressiveRender;
    private diff;
    private renderChatContentPart;
    private renderUndoStop;
    private renderNoContent;
    private renderTreeData;
    private renderContentReferencesListData;
    private renderCodeCitations;
    private getCodeBlockStartIndex;
    private handleRenderedCodeblocks;
    private renderToolInvocation;
    private renderProgressTask;
    private renderWorkingProgress;
    private renderConfirmation;
    private renderAttachments;
    private renderTextEdit;
    private renderMarkdown;
    disposeElement(node: ITreeNode<ChatTreeItem, FuzzyScore>, index: number, templateData: IChatListItemTemplate): void;
    disposeTemplate(templateData: IChatListItemTemplate): void;
}
export declare class ChatListDelegate implements IListVirtualDelegate<ChatTreeItem> {
    private readonly defaultElementHeight;
    private readonly logService;
    constructor(defaultElementHeight: number, logService: ILogService);
    private _traceLayout;
    getHeight(element: ChatTreeItem): number;
    getTemplateId(element: ChatTreeItem): string;
    hasDynamicHeight(element: ChatTreeItem): boolean;
}
export declare class ChatVoteDownButton extends DropdownMenuActionViewItem {
    private readonly commandService;
    private readonly issueService;
    private readonly logService;
    constructor(action: IAction, options: IDropdownMenuActionViewItemOptions | undefined, commandService: ICommandService, issueService: IWorkbenchIssueService, logService: ILogService, contextMenuService: IContextMenuService);
    getActions(): readonly IAction[];
    render(container: HTMLElement): void;
    private getVoteDownDetailAction;
}
export {};
