import { Disposable } from "@codingame/monaco-vscode-api/vscode/vs/base/common/lifecycle";
import { URI } from "@codingame/monaco-vscode-api/vscode/vs/base/common/uri";
import { IActiveCodeEditor } from "@codingame/monaco-vscode-api/vscode/vs/editor/browser/editorBrowser";
import { ISingleEditOperation } from "@codingame/monaco-vscode-api/vscode/vs/editor/common/core/editOperation";
import { ILanguageService } from "@codingame/monaco-vscode-api/vscode/vs/editor/common/languages/language.service";
import { IEditorWorkerService } from "@codingame/monaco-vscode-api/vscode/vs/editor/common/services/editorWorker.service";
import { IModelService } from "@codingame/monaco-vscode-api/vscode/vs/editor/common/services/model.service";
import { IContextKeyService } from "@codingame/monaco-vscode-api/vscode/vs/platform/contextkey/common/contextkey.service";
import { IInstantiationService } from "@codingame/monaco-vscode-api/vscode/vs/platform/instantiation/common/instantiation";
import { IStorageService } from "@codingame/monaco-vscode-api/vscode/vs/platform/storage/common/storage.service";
import { IChatModel } from "../../../../chat/common/chatModel.js";
import { IChatService } from "@codingame/monaco-vscode-api/vscode/vs/workbench/contrib/chat/common/chatService.service";
import { ProgressingEditsOptions } from "@codingame/monaco-vscode-29bc1406-2925-5b8f-b25e-d04a7772d896-common/vscode/vs/workbench/contrib/inlineChat/browser/inlineChatStrategies";
import { ICellViewModel, INotebookEditor, INotebookEditorContribution } from "../../notebookBrowser.js";
import { INotebookExecutionStateService } from "@codingame/monaco-vscode-api/vscode/vs/workbench/contrib/notebook/common/notebookExecutionStateService.service";
export interface INotebookCellTextModelLike {
    uri: URI;
    viewType: string;
}
export declare class NotebookChatController extends Disposable implements INotebookEditorContribution {
    private readonly _notebookEditor;
    private readonly _instantiationService;
    private readonly _contextKeyService;
    private readonly _editorWorkerService;
    private readonly _modelService;
    private readonly _languageService;
    private _executionStateService;
    private readonly _storageService;
    private readonly _chatService;
    static id: string;
    static counter: number;
    static get(editor: INotebookEditor): NotebookChatController | null;
    private static _storageKey;
    private static _promptHistory;
    private _historyOffset;
    private _historyCandidate;
    private _historyUpdate;
    private _promptCache;
    private readonly _onDidChangePromptCache;
    readonly onDidChangePromptCache: import("@codingame/monaco-vscode-api/vscode/vs/base/common/event").Event<{
        cell: URI;
    }>;
    private _strategy;
    private _sessionCtor;
    private _activeRequestCts?;
    private readonly _ctxHasActiveRequest;
    private readonly _ctxCellWidgetFocused;
    private readonly _ctxUserDidEdit;
    private readonly _ctxOuterFocusPosition;
    private readonly _userEditingDisposables;
    private readonly _widgetDisposableStore;
    private _focusTracker;
    private _widget;
    private readonly _model;
    constructor(_notebookEditor: INotebookEditor, _instantiationService: IInstantiationService, _contextKeyService: IContextKeyService, _editorWorkerService: IEditorWorkerService, _modelService: IModelService, _languageService: ILanguageService, _executionStateService: INotebookExecutionStateService, _storageService: IStorageService, _chatService: IChatService);
    private _registerFocusTracker;
    run(index: number, input: string | undefined, autoSend: boolean | undefined): void;
    restore(editingCell: ICellViewModel, input: string): void;
    private _disposeWidget;
    private _createWidget;
    private _startSession;
    private _scrollWidgetIntoView;
    private _focusWidget;
    private _updateNotebookEditorFocusNSelections;
    hasSession(chatModel: IChatModel): boolean;
    getSessionInputUri(): URI | undefined;
    acceptInput(): Promise<void>;
    private _makeChanges;
    private _updateUserEditingState;
    acceptSession(): Promise<void>;
    focusAbove(): Promise<void>;
    focusNext(): Promise<void>;
    hasFocus(): boolean;
    focus(): void;
    focusNearestWidget(index: number, direction: "above" | "below"): void;
    populateHistory(up: boolean): void;
    cancelCurrentRequest(discard: boolean): Promise<void>;
    getEditingCell(): ICellViewModel | null | undefined;
    discard(): void;
    dismiss(discard: boolean): void;
    isCellGeneratedByChat(cell: ICellViewModel): boolean;
    getPromptFromCache(cell: ICellViewModel): string | undefined;
    dispose(): void;
}
export declare class EditStrategy {
    private _editCount;
    constructor();
    makeProgressiveChanges(editor: IActiveCodeEditor, edits: ISingleEditOperation[], opts: ProgressingEditsOptions): Promise<void>;
    makeChanges(editor: IActiveCodeEditor, edits: ISingleEditOperation[]): Promise<void>;
}
