## Api

Здесь находятся 4 директории. 
Они очень плотно связаны между собой, потому что хэндлеры отправляют загруженные данными
шаблоны из папки `templates`, а в свою очередь к шаблонам подключены стили сгенерированные
`tailwindcss` из папки `static`


Пройдемся по порядку каждой из них:

### handlers/

#### `handlers.go`
Этот модуль определяет структуру `Handler` хранящую две переменные:
`svc` - структура сервисов нашего приложения
`db` - это интерфейс базы данных для взаимодействия с ней

Дальше функция создания новой инстанции этой структуры
`func NewHandler` возвращающая новый `Handler`


#### `health.go`
Это так называемый healthcheck приложения, функция
`HealthCheckHandler` обрабатывает запрос типа healthcheck, возвращая код 200, который
означает что приложение работает


#### `routes.go`
pass

#### `auth.go`
Это модуль отвечающий за аутентификацию пользователей, их логин и регистрацию и 
JWT токены

`func (h *Handler) Register` это функция отвечает за регистрацию пользователя, она 
расшифровывает из запроса логин и пароль пользователя, шифрует пароль с помощью `bcrypt`
и создает пользователя в базе данных. Дальше она перенаправляет пользоваетеля на страницу 
логина

`func (h *Handler) Login` эта функция занимается логикой логина пользователя, она расшифровывает из
запроса логин и пароль пользователя, дальше функция `Authenticate` - проверяет есть ли в базе данных такой
пользователь и если есть проверяет его пароль и пароль из запроса на сходство (естественно зашифрованные),
а потом создается `JWT токен` пользователя через функцию `CreateJWT` - которая просто создает токен, который и возвращает его.
Дальше функция `Login` устанавливает сессионные куки на jwt токен и перенаправляет пользователя на главную страницу


#### `c_analyze.go`
Это модуль отвечающий за запросы приходящие на бэкенд связаные с анализом языка C

В начале определяются две структуры:

`CAnalyzeRequest` - структура отвечающая за запрос, здесь находится одно поле `CCode`
`CData` - структура отвечающая за возвращаемые данные, среди них:
`Result` `Metrics` `Recommendations` `LLMAnswer`.

Дальше идут функции, первая из которых - `CAnalyzeData`, которая:
1. Расшифровивает запрос, проверяя при этом не прислан ли пустой код
2. Запускает контейнер вместе с метриками
3. Генерирует Реккомендации
4. Парсит ответ из контейнера и реккомендации
5. Отправляет запрос в нейросеть, для генерации дополнительных рекомендаций
6. Возвращает структуру ответа


`AnalyzeHandlerTemplateC` - это уже функция отвечающая за обработку вставку данных в шаблон и высылание этого шаблона.
В параметрах контекст `echo`, нужный для работы с REST API

Первое что делает функция это расшифровка данных уже из запроса к API,
потом идет вызов предыдущей функции, для получения данных анализа
и на конец все данные вставляются в шаблон `c_analytics.html` (движок шаблонов в go позволяет не писать .html) и шаблон рендерится,
то есть отправляется клиенту

Дальше идет секция статического анализа кода, так называемые линтеры

По аналогии с динамическим анализом идет определение структуры
`CLintRequest`, отвечающую за запрос, хранят одно текстовое поле соответственно код в C и статический анализ

Дальше идет функция `CLintHandler`, которая берет код из запроса, запускает функцию по статическому анализу:
`LintCInContainer` и возвращает данные из этого контейнера обернутые в html

#### `python_analyze.go`
Это файл/модуль отвечающий за обработку запросов связаных с анализом python

В начале определяются две структуры:

`PythonAnalyzeRequest` - структура отвечающая за запрос, здесь находится одно поле `PythonCode`
`PythonData` - структура отвечающая за возвращаемые данные, среди них:
`Result` `Metrics` `Recommendations` `LLMAnswer`.

Дальше идут функции, первая из которых - `PythonAnalyzeData`, которая:
1. Расшифровивает запрос, проверяя при этом не прислан ли пустой код
2. Запускает контейнер вместе с метриками
3. Генерирует Реккомендации
4. Парсит ответ из контейнера и реккомендации
5. Отправляет запрос в нейросеть, для генерации дополнительных рекомендаций
6. Возвращает структуру ответа


`AnalyzeHandlerTemplatePython` - это уже функция отвечающая за обработку вставку данных в шаблон и высылание этого шаблона.
В параметрах контекст `echo`, нужный для работы с REST API

Первое что делает функция это расшифровка данных уже из запроса к API,
потом идет вызов предыдущей функции, для получения данных анализа
и на конец все данные вставляются в шаблон `python_analytics.html` (движок шаблонов в go позволяет не писать .html) и шаблон рендерится,
то есть отправляется клиенту

Дальше идет секция статического анализа кода, так называемые линтеры

По аналогии с динамическим анализом идет определение структуры
`PythonLintRequest`, отвечающую за запрос, хранят одно текстовое поле соответственно код в C и статический анализ

Дальше идет функция `PythonLintHandler`, которая берет код из запроса, запускает функцию по статическому анализу:
`LintPythonInContainer` и возвращает данные из этого контейнера обернутые в html


#### `sql_analyze.go`
Это файл/модуль отвечающий за обработку запросов связаных с анализом sql

В начале определяются две структуры:

`AnalyzeRequest` - структура отвечающая за запрос, здесь находится два поля: `SQLQuery` - запрос в sql, `InitSQL` - база данных
`Data` - структура отвечающая за возвращаемые данные, среди них:
`Result` `Metrics` `Analytics` `Recommendations` `LLMAnswer`.

Дальше идут функции, первая из которых - `AnalyzeData`, которая:
1. Расшифровивает запрос, проверяя при этом не прислан ли пустой код
2. Запускает контейнер вместе с метриками
3. Генерирует Рекомендации
4. Парсит ответ из контейнера и реккомендации
5. Отправляет запрос в нейросеть, для генерации дополнительных рекомендаций
6. Возвращает структуру ответа


`AnalyzeHandlerTemplate` - это уже функция отвечающая за обработку вставку данных в шаблон и высылание этого шаблона.
В параметрах контекст `echo`, нужный для работы с REST API

Первое что делает функция это расшифровка данных уже из запроса к API,
потом идет вызов предыдущей функции, для получения данных анализа
и на конец все данные вставляются в шаблон `sql_analytics.html` (движок шаблонов в go позволяет не писать .html) и шаблон рендерится,
то есть отправляется клиенту

